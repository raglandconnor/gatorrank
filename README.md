# gatorrank

A website for ranking student-made projects at UF.

## Table of Contents

- [Tech Stack](#tech-stack)
- [Installation](#installation)
  - [Backend](#backend)
  - [Database Migrations (Alembic)](#database-migrations-alembic)
  - [Frontend](#frontend)
  - [Pre-commit Hooks](#pre-commit-hooks)
- [Contributing](#contributing)
  - [Workflow](#workflow)
  - [CI](#ci)
  - [Branching Strategy](#branching-strategy)

## Tech Stack

Backend:

- Python 3.12+
- FastAPI
- Pydantic
- SQLAlchemy
- Supabase
- uv

Frontend:

- TypeScript
- Next.js 16
- Chakra UI
- Bun

## Installation

### Backend

1. Sync dependencies with [uv](https://docs.astral.sh/uv/getting-started/installation/):
  ```bash
   cd backend
   uv sync
  ```
2. Select the Python interpreter in VS Code:
  - Press `Cmd+Shift+P` or `Ctrl+Shift+P`
  - Type "Python: Select Interpreter"
  - Choose `./backend/.venv/bin/python3`
3. Run the FastAPI server:
  ```bash
   uv run uvicorn app.main:app --reload
  ```
   The backend server will be available at `http://localhost:8000`
   API documentation (Swagger UI) is available at `http://localhost:8000/docs`
4. To run backend tests:
  ```bash
   uv run pytest
  ```

### Database Migrations (Alembic)

Migrations are managed in `backend/alembic/` and use the backend `DATABASE_URL` from `backend/.env`.

1. Apply all pending migrations:
  ```bash
   cd backend
   uv run alembic upgrade head
  ```
2. Create a new migration after changing SQLModel models:
  ```bash
   cd backend
   uv run alembic revision --autogenerate -m "describe schema change"
  ```
3. Apply one new migration (or all pending):
  ```bash
   cd backend
   uv run alembic upgrade head
  ```
4. Roll back the most recent migration:
  ```bash
   cd backend
   uv run alembic downgrade -1
  ```
5. View migration history:
  ```bash
   cd backend
   uv run alembic history
   uv run alembic current
  ```

Notes:

- Alembic derives a sync migration URL automatically from `DATABASE_URL` (you do not need a separate env var).
- Always review autogenerated migration files before running `upgrade`.

### Frontend

1. Install dependencies with [bun](https://bun.sh):
  ```bash
   cd frontend
   bun install
  ```
2. Run the Next.js development server:
  ```bash
   bun dev
  ```
   The frontend will be available at `http://localhost:3000`

### Pre-commit Hooks

Pre-commit runs a small set of automated checks before commits. In this repo it:

- trims trailing whitespace and ensures files end with a newline
- runs `ruff` + `ruff format` for backend Python files
- runs `pyright` for backend type checking
- runs `eslint` and `tsc --noEmit` for frontend linting and type checking
- runs `prettier` for frontend TypeScript/JavaScript/CSS/JSON/YAML/Markdown files

Install the pre-commit runner once:

```bash
uv tool install pre-commit
```

Then enable the hooks for this repo:

```bash
# in the project root
pre-commit install
pre-commit run --all-files
```

> **Note:**
> If a pre-commit hook auto-fixes files during `git commit`, pre-commit will stop the commit so you can review the changes.
> Re-stage the modified files (e.g., `git add <files>`) and run `git commit` again.

## Contributing

### Workflow

1. Create a feature branch from `main`
2. Make your changes
3. Open a pull request to `main`
4. Get review approval before merging

### CI

GitHub Actions automatically runs `pre-commit run --all-files` on every pull request and whenever commits are pushed to or merged into `main`.

### Branching Strategy

- `main` - Production-ready code
- `feature/`* - New features and changes
- `fix/*` - Bug fixes
- `refactor/*` - Code refactoring
- `hotfix/*` - Urgent production fixes
- `docs/*` - Documentation updates
- `test/*` - Test additions or updates
- `style/*` - Code style changes
